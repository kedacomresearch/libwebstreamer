cmake_minimum_required(VERSION 2.8)
project(libwebstreamer)

include( AutoCMake.cmake )

autocmake_pkgconfig_init()

#include_directories(lib)
include_directories(${CMAKE_CURRENT_SOURCE_DIR}/include)

#add_library( libwebstreamer SHARED lib/source/example.cpp)
file( GLOB_RECURSE _SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/source/*.cpp
                            ${CMAKE_CURRENT_SOURCE_DIR}/source/*.cc
                            ${CMAKE_CURRENT_SOURCE_DIR}/source/*.h
                            ${CMAKE_CURRENT_SOURCE_DIR}/source/*.c)
							
file( GLOB_RECURSE _HEADERS ${CMAKE_CURRENT_SOURCE_DIR}/include/*.inl 
                            ${CMAKE_CURRENT_SOURCE_DIR}/include/*.h 
                            ${CMAKE_CURRENT_SOURCE_DIR}/include/*.hpp)

list(APPEND _FILES ${_SOURCES} ${_HEADERS})
autocmake_msvc_project_group( _FILES ${CMAKE_CURRENT_SOURCE_DIR})

autocmake_add_library(libwebstreamer  SHARED
             SOURCES ${_FILES}
             MODULES gstreamer-rtsp-server-1.0 gstreamer-1.0 glib-2.0 json-glib-1.0 openwebrtc-lite-0.3
			 )

target_link_libraries(libwebstreamer flatbuffers)
link_directories(libwebstreamer ${DCMAKE_INSTALL_PREFIX}/lib)

if(MSVC)

else()			 
set_target_properties(libwebstreamer PROPERTIES PREFIX "lib")
set_target_properties(libwebstreamer PROPERTIES OUTPUT_NAME "webstreamer")
set_target_properties(libwebstreamer PROPERTIES EXPORT_NAME "libwebstreamer")
endif()
#set_target_properties(libwebstreamer PROPERTIES VERSION 1.1 SOVERSION 1)

install(TARGETS libwebstreamer
        LIBRARY DESTINATION lib 
        ARCHIVE DESTINATION lib
		RUNTIME DESTINATION bin
		)
#INSTALL(FILES ${CMAKE_SOURCE_DIR}/lib/libwebstreamer.hpp  DESTINATION include )